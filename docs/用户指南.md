# Web3区块链风控监控平台使用指南

## 项目概述

本项目是一个基于Java和Go的Web3区块链风控监控平台，提供实时交易监控、风险评估、告警管理等功能。

## 核心功能

### 1. 实时区块链数据采集与监控
- **多链支持**: 以太坊主网、BSC、Polygon、Arbitrum
- **实时监控**: WebSocket订阅 + REST API轮询
- **数据处理**: 智能过滤、去重、标准化
- **性能优化**: 批量处理、并发采集

### 2. 智能风险识别与评估
- **地址风险评估**: 黑名单、制裁名单、混币器检测
- **交易行为分析**: 大额交易、异常模式、时间分析
- **智能合约检测**: 安全扫描、权限分析、漏洞识别
- **资金流向追踪**: 多跳转账、聚集分析、合规检查

### 3. 告警管理与通知系统
- **实时告警**: 5秒内高危交易预警
- **多级告警**: CRITICAL/HIGH/MEDIUM/LOW/INFO
- **通知渠道**: 邮件、短信、微信、Webhook
- **处理流程**: 状态跟踪、升级机制、误报学习

### 4. 可视化监控面板
- **实时仪表盘**: 风险指标、交易统计、网络状态
- **历史报告**: 日度/周度/月度风险分析
- **自定义分析**: 灵活查询、数据导出

## 快速开始

### 环境要求
- Java 17+
- Go 1.21+
- Docker & Docker Compose
- PostgreSQL 15+
- Redis 7+
- Apache Kafka

### 安装步骤

1. **克隆项目**
```bash
git clone <repository-url>
cd 风控
```

2. **启动基础设施**
```bash
cd docker
docker-compose up -d
```

3. **启动Go数据采集服务**
```bash
cd data-collector
go mod tidy
go run main.go
```

4. **启动Java风险引擎**
```bash
cd backend/risk-engine
./mvnw spring-boot:run
```

5. **访问服务**
- Grafana监控: http://localhost:3000
- API文档: http://localhost:8080/swagger-ui.html
- 数据采集API: http://localhost:8082/api/v1

## API接口说明

### Go数据采集服务 (端口8082)

#### 获取服务状态
```bash
GET /api/v1/status
```

#### 获取网络统计
```bash
GET /api/v1/networks
GET /api/v1/networks/ethereum/stats
```

#### 获取性能指标
```bash
GET /api/v1/metrics/performance
```

### Java风险引擎服务 (端口8080)

#### 交易风险评估
```bash
POST /api/v1/risk/evaluate
{
  "txHash": "0x...",
  "fromAddress": "0x...",
  "toAddress": "0x...",
  "amount": "1000000000000000000",
  "network": "ethereum"
}
```

#### 地址风险查询
```bash
GET /api/v1/risk/address/{address}
```

#### 告警管理
```bash
GET /api/v1/alerts
POST /api/v1/alerts/{id}/acknowledge
```

## 配置说明

### Go服务配置 (data-collector/config.yml)
```yaml
blockchain:
  networks:
    ethereum:
      rpc_url: "YOUR_ETHEREUM_RPC_URL"
      ws_url: "YOUR_ETHEREUM_WS_URL"
      enabled: true
```

### Java服务配置 (application.yml)
```yaml
spring:
  datasource:
    url: jdbc:postgresql://localhost:5432/web3_risk_db
    username: web3_user
    password: web3_password
```

## 监控与运维

### 健康检查
```bash
# Go服务健康检查
curl http://localhost:8082/health

# Java服务健康检查
curl http://localhost:8080/actuator/health
```

### 日志查看
```bash
# Go服务日志
tail -f data-collector/logs/app.log

# Java服务日志
tail -f backend/risk-engine/logs/risk-engine.log
```

### 性能监控
- Prometheus指标: http://localhost:9090
- Grafana面板: http://localhost:3000
- 应用指标: http://localhost:8080/actuator/prometheus

## 风险规则配置

### 创建自定义规则
```sql
INSERT INTO risk_rules (rule_name, rule_type, condition_json, action, risk_weight, severity) 
VALUES (
  'HighValueTransaction', 
  'THRESHOLD', 
  '{"field": "value", "operator": "gt", "value": "1000000000000000000000"}',
  'ALERT',
  0.8,
  'HIGH'
);
```

### 规则类型说明
- **TRANSACTION**: 交易级规则
- **ADDRESS**: 地址级规则
- **PATTERN**: 模式识别规则
- **BLACKLIST**: 黑名单规则
- **THRESHOLD**: 阈值规则

## 常见问题

### Q: 如何添加新的区块链网络？
A: 在`data-collector/config.yml`中添加网络配置，并更新相应的连接器代码。

### Q: 如何自定义风险评分算法？
A: 修改`data-collector/internal/processor/risk_detector.go`中的风险检测逻辑。

### Q: 如何配置告警通知？
A: 在Java服务中配置告警服务，支持邮件、短信、Webhook等多种通知方式。

### Q: 如何扩展数据处理能力？
A: 增加Kafka分区数量，调整Go服务的worker数量，优化数据库索引。

## 开发指南

### 添加新的风险检测规则
1. 在`RiskDetector`中添加检测逻辑
2. 更新规则配置数据库
3. 编写单元测试
4. 更新文档

### 扩展API接口
1. 在controller中添加新端点
2. 实现service层逻辑
3. 添加Swagger文档注解
4. 编写集成测试

## 技术支持

如有问题，请通过以下方式联系：
- 提交Issue到项目仓库
- 邮件联系开发团队
- 查看项目Wiki文档

## 许可证

本项目采用MIT许可证，详见LICENSE文件。